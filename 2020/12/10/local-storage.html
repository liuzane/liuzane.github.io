<!doctype html><html lang="en"><head><meta charset="utf-8"><title>localStorage - LiuZheng&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/article.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="container"><div id="nav"><nav id="nav-wrap"><a class="nav-link" href="/">Home</a> <a class="nav-link" href="/archives">Archives</a> <a class="nav-link" href="/categories">Categories</a> <a class="nav-link" href="https://liuzane.github.io/tools">Tools</a> <a class="nav-link" href="/about">About</a></nav><div class="frosted-glass"></div></div><div id="wrapper"><header id="header"><div class="header-wrapper"><img src="/images/aodamiao.jpg" class="header-avatar"><p class="header-author">Zheng Liu</p><p class="header-description">Study hard and make progress every day</p></div><div class="frosted-glass"></div></header><section id="content"><article class="article"><a class="article-back" href="javascript: history.back(-1)">&lt; Back</a><header class="article-header"><h1 class="article-title">localStorage</h1><div class="article-meta"><time datetime="2020-12-10T10:05:54.000Z" class="article-date">2020-12-10</time></div></header><div class="article-content"><ul><li><h4 id="setStorage-key-data-hours"><a href="#setStorage-key-data-hours" class="headerlink" title="setStorage(key, data, hours)"></a>setStorage(key, data, hours)</h4><p>设置localStorage</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@method <span class="variable">setStorage</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">key</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;any&#125;</span> <span class="variable">data</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;number&#125;</span> <span class="variable">hours</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@return <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setStorage</span>(<span class="params">key, data, hours</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> expires;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!key || !data) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">&#x27;[localStorage Error]: Key and Data is a must parameter&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  expires = hours ? <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() + <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * hours : <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">0</span>).getTime();</span><br><span class="line">  <span class="built_in">localStorage</span>.setItem(key, <span class="built_in">JSON</span>.stringify(&#123; data, expires &#125;));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h4 id="getStorage-key"><a href="#getStorage-key" class="headerlink" title="getStorage(key)"></a>getStorage(key)</h4><p>获取localStorage</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@method <span class="variable">getStorage</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">key</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@return <span class="type">&#123;boolean|null&#125;</span></span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStorage</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> data, nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!key) <span class="built_in">console</span>.error(<span class="string">&#x27;[localStorage Error]: Key is a must parameter&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    data = <span class="built_in">JSON</span>.parse(<span class="built_in">localStorage</span>.getItem(key));</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">localStorage</span>.getItem(key);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!data) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Boolean</span>(data.expires) || data.expires &gt;= nowTime) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.data;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">localStorage</span>.removeItem(key);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h4 id="clearStorage-key"><a href="#clearStorage-key" class="headerlink" title="clearStorage(key)"></a>clearStorage(key)</h4><p>清除localStorage</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@method <span class="variable">clearStorage</span></span></span></span><br><span class="line"><span class="comment">* <span class="doctag">@param <span class="type">&#123;string&#125;</span> <span class="variable">key</span></span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clearStorage</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (key) &#123;</span><br><span class="line">    <span class="built_in">localStorage</span>.removeItem(key);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">localStorage</span>.clear();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></div></article></section><footer id="footer"><div class="footer-wrapper"><a href="/" class="footer-title">LiuZheng's Blog</a><p>Theme from by Lite</p></div><div class="frosted-glass"></div></footer></div></div></body></html>