<!doctype html><html lang="en"><head><meta charset="utf-8"><title>NPM Error Resolve - LiuZheng&#39;s Blog</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="google-site-verification" content="7if7tEoBzofIpEcyTBbXYj68Uwni_Udf_J_RnIMKkx0"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/article.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="container"><div id="nav"><nav id="nav-wrap"><a class="nav-link" href="/">Home</a> <a class="nav-link" href="/archives">Archives</a> <a class="nav-link" href="/categories">Categories</a> <a class="nav-link" href="https://liuzane.github.io/tools">Tools</a> <a class="nav-link" href="/about">About</a></nav><div class="frosted-glass"></div></div><div id="wrapper"><header id="header"><div class="header-wrapper"><img src="/images/aodamiao.jpg" class="header-avatar"><p class="header-author">Zheng Liu</p><p class="header-description">Study hard and make progress every day</p></div><div class="frosted-glass"></div></header><section id="content"><article class="article"><a class="article-back" href="javascript: history.back(-1)">&lt; Back</a><header class="article-header"><h1 class="article-title">NPM Error Resolve</h1><div class="article-meta"><time datetime="2024-11-01T07:03:05.000Z" class="article-date">2024-11-01</time></div></header><div class="article-content"><h3 id="postinstall-error"><a href="#postinstall-error" class="headerlink" title="postinstall error"></a>postinstall error</h3><table><thead><tr><th>环境</th><th>版本</th></tr></thead><tbody><tr><td>windows</td><td>10</td></tr><tr><td>node</td><td>20.14.0</td></tr><tr><td>pnpm</td><td>9.4.0</td></tr></tbody></table><p>当第一次执行 <code>pnpm install</code> 或 <code>npm install</code> 时 PNPM报错：npm postinstall failed command not found node ./scripts/postinstall.js<br><img src="./npm-error-resolve/2024-11-01-150359.png" alt=" "></p><h4 id="解决方案1："><a href="#解决方案1：" class="headerlink" title="解决方案1："></a>解决方案1：</h4><p>运行命令<br><code>rimraf .\node_modules\</code><br><code>npm cache clean --force</code><br><code>pnpm store prune</code></p><h4 id="解决方案2："><a href="#解决方案2：" class="headerlink" title="解决方案2："></a>解决方案2：</h4><ol><li><p>找到报错的插件所在的 package.json 文件</p></li><li><p>把 package.json 中的 scripts.postinstall 的命令找个地方记录下来，并修改命令为 <code>pnpm --version</code></p></li><li><p>然后执行一次 <code>pnpm install</code> 完成后将会发现报错的插件 postinstall 执行成功</p></li><li><p>挨个进入报错的插件所在的 package.json 文件层级</p></li><li><p>挨个执行该插件原有的 postinstall 命令</p></li><li><p><code>pnpm dev</code> 启动成功。。。</p></li></ol><h3 id="node-pre-gyp-error"><a href="#node-pre-gyp-error" class="headerlink" title="node-pre-gyp error"></a>node-pre-gyp error</h3><table><thead><tr><th>插件</th><th>版本</th></tr></thead><tbody><tr><td>linux</td><td>13.6.0</td></tr><tr><td>node</td><td>18.20.4</td></tr><tr><td>npm</td><td>10.7.0</td></tr></tbody></table><p>当第一次执行 <code>npm install</code> 时，有时会出现 npm error node-pre-gyp。<br><img src="./npm-error-resolve/2024-11-01-154318.png" alt=" "></p><h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p><a target="_blank" rel="noopener" href="https://github.com/mozilla/pdf.js#user-content-getting-the-code">https://github.com/mozilla/pdf.js#user-content-getting-the-code</a></p><blockquote><p>On MacOS M1/M2 you may see some node-gyp-related errors when running npm install. This is because one of our dependencies, “canvas”, does not provide pre-built binaries for this platform and instead npm will try to build it from source. Please make sure to first install the necessary native dependencies using brew: <a target="_blank" rel="noopener" href="https://github.com/Automattic/node-canvas#compiling">https://github.com/Automattic/node-canvas#compiling</a>.</p></blockquote><h4 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h4><ol><li><p>参考 <a target="_blank" rel="noopener" href="https://github.com/Automattic/node-canvas#compiling">https://github.com/Automattic/node-canvas#compiling</a> 给的解决办法，给环境添加图片插件支持。</p></li><li><p>移除项目中所有与 canvas (项目名: node-canvas) 相关的插件。</p></li></ol></div></article></section><footer id="footer"><div class="footer-wrapper"><a href="/" class="footer-title">LiuZheng's Blog</a><p>Theme from by Lite</p></div><div class="frosted-glass"></div></footer></div></div></body></html>