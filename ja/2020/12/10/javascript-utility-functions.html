<!doctype html><html lang="en"><head><meta charset="utf-8"><title>JavaScript Utility Functions</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="google-site-verification" content="7if7tEoBzofIpEcyTBbXYj68Uwni_Udf_J_RnIMKkx0"><link rel="alternate" href="https://liuzane.github.io/en" hreflang="en"><link rel="alternate" href="https://liuzane.github.io/zh" hreflang="zh"><link rel="alternate" href="https://liuzane.github.io/ja" hreflang="ja"><link rel="alternate" href="https://liuzane.github.io" hreflang="x-default"><link rel="canonical" href="https://liuzane.github.io/ja/2020/12/10/javascript-utility-functions.html"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/article.css"></head><body><div id="container"><div id="nav"><nav id="nav-wrap"><a class="nav-link" href="/ja">ホーム</a> <a class="nav-link" href="/ja/archives">アーカイブ</a> <a class="nav-link" href="/ja/categories">カテゴリ</a> <a class="nav-link" href="https://liuzane.github.io/tools" target="_blank">ツール</a> <a class="nav-link" href="https://liuzane.github.io/laboratory" target="_blank">ラボ</a> <a class="nav-link" href="/ja/about">紹介</a></nav><div class="frosted-glass"></div></div><div id="nav-lang"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em"><path d="M512 742.4a230.4 230.4 0 1 0 0-460.8 230.4 230.4 0 0 0 0 460.8z m0 57.6a288 288 0 1 1 0-576 288 288 0 0 1 0 576zM380.256 267.2l25.664-13.984c0-0.8-0.032-0.832 4.832 3.2 25.6 26.976 38.368 49.92 38.368 68.8 0 5.312 0.192 10.08 0.736 19.776 1.792 31.232 1.376 43.04-5.664 58.88-10.848 24.544-34.176 36.544-67.072 36.544-27.456 0-49.696 6.464-88.96 23.296-30.4 13.024-33.28 14.208-45.952 18.432l10.592-41.728c10.432-3.456-15.68-17.504 12.704-29.664 45.888-19.648 74.336-27.936 111.616-27.936 7.392 0 12-0.896 14.208-2.048 1.92-4.128 2.24-11.712 1.024-32.512-0.64-10.752-0.832-16.288-0.832-23.04 0-8.256-16.48-23.552-17.632-24.512-16.8-13.984 6.4-12.832 6.4-33.504z m225.312 325.728c-24.896-13.632-41.024-28.512-48.896-52.096-2.656-8-8.832-13.952-20.128-19.712-5.248-2.656-24.832-10.624-27.776-12.032-15.68-7.52-25.568-16.544-25.568-34.944 0-16.224 0.864-27.68 4.512-41.856 5.952-23.008 17.92-42.144 37.824-54.592 17.664-11.04 36.288-12.128 56.832-5.92 6.848 2.048 13.568 4.736 22.784 8.864-0.928-0.448 16.96 7.68 22.24 9.984 12.736 5.472 23.808 9.408 35.584 12.352a205.216 205.216 0 0 0 101.248 0l13.952 55.904a262.784 262.784 0 0 1-129.152 0 283.04 283.04 0 0 1-44.416-15.36c-47.584-20.48-44.448-19.52-48.544-16.96-8.896 5.568-13.312 16.864-14.72 33.792 6.784 2.848 16.416 6.944 21.344 9.44 23.584 12 40.448 28.32 48.64 52.832 2.208 6.592 8.544 12.48 21.888 19.776 3.2 1.76 17.12 8.832 20.64 10.752 26.528 14.624 40.512 33.184 28.736 61.6-9.152 22.08-25.088 32.928-54.72 44.576-0.96 0.384-19.648 7.488-25.152 9.76-9.28 3.808-17.024 7.488-24.224 11.648a137.6 137.6 0 0 0-7.328 4.544c-19.904 13.28-30.368 37.728-30.368 76.864h-57.6c0-56.896 18.336-99.648 56-124.8 3.424-2.24 6.88-4.384 10.432-6.432a248.64 248.64 0 0 1 31.232-15.136c6.304-2.56 25.568-9.92 25.92-10.048a168.32 168.32 0 0 0 12.768-5.504 1102.944 1102.944 0 0 1-13.984-7.296z" p-id="1465"></path></svg></div><div id="nav-lang-list"><a class="lang-link" href="/en/2020/12/10/javascript-utility-functions.html" hreflang="en">English</a> <a class="lang-link" href="/zh/2020/12/10/javascript-utility-functions.html" hreflang="zh">简体中文</a> <a class="lang-link" href="/ja/2020/12/10/javascript-utility-functions.html" hreflang="ja">日本語</a></div><div id="wrapper"><header id="header"><div class="header-wrapper"><img src="/images/aodamiao.jpg" class="header-avatar"><p class="header-author">柳政</p><p class="header-description">日々精進、向上心を忘れず</p></div><div class="frosted-glass"></div></header><section id="content"><article class="article"><a class="article-back" href="javascript: history.back(-1)">&lt; 戻る</a><header class="article-header"><h1 class="article-title">JavaScript Utility Functions</h1><div class="article-meta"><time datetime="2024-05-16T10:35:00.000Z" class="article-date">2024-05-16</time></div></header><div class="article-content"><h4 id="メソッド集："><a href="#メソッド集：" class="headerlink" title="メソッド集："></a>メソッド集：</h4><table><thead><tr><th>メソッド名</th><th>説明</th></tr></thead><tbody><tr><td><a href="#typeOf-anything">typeOf</a></td><td>データ型を検証します。</td></tr><tr><td><a href="#deepCopy-data">deepCopy</a></td><td>ディープコピー。</td></tr><tr><td><a href="#uuid">uuid</a></td><td>UUID を生成します。</td></tr><tr><td><a href="#download-url-name">download</a></td><td>ダウンロード。</td></tr><tr><td><a href="#getUrlArg-name">getUrlArg</a></td><td>名前でパスパラメータを取得します。</td></tr><tr><td><a href="#getUrlQuery-name">getUrlQuery</a></td><td>パスパラメータをオブジェクト形式に変換します。</td></tr><tr><td><a href="#setUrlQuery-url">setUrlQuery</a></td><td>オブジェクト形式をパスパラメータに変換します。</td></tr><tr><td><a href="#getDeepValueOfObject-object-keyPath-defaultValue">getDeepValueOfObject</a></td><td>オブジェクトの深い値を取得します。</td></tr><tr><td><a href="#toThousands-number">toThousands</a></td><td>千位区切り形式に変換します。</td></tr></tbody></table><ul><li><h4 id="typeOf-anything"><a href="#typeOf-anything" class="headerlink" title="typeOf(anything)"></a>typeOf(anything)</h4><p>データ型を検証します。</p><blockquote><p>戻り値はすべて文字列です</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">TypeValue</span> &#123;</span><br><span class="line">  <span class="title class_">Boolean</span> = <span class="string">&#x27;boolean&#x27;</span>,</span><br><span class="line">  <span class="title class_">Number</span> = <span class="string">&#x27;number&#x27;</span>,</span><br><span class="line">  <span class="title class_">String</span> = <span class="string">&#x27;string&#x27;</span>,</span><br><span class="line">  <span class="title class_">Function</span> = <span class="string">&#x27;function&#x27;</span>,</span><br><span class="line">  <span class="title class_">Array</span> = <span class="string">&#x27;array&#x27;</span>,</span><br><span class="line">  <span class="title class_">Date</span> = <span class="string">&#x27;date&#x27;</span>,</span><br><span class="line">  <span class="title class_">RegExp</span> = <span class="string">&#x27;regexp&#x27;</span>,</span><br><span class="line">  <span class="title class_">Undefined</span> = <span class="string">&#x27;undefined&#x27;</span>,</span><br><span class="line">  <span class="title class_">Null</span> = <span class="string">&#x27;null&#x27;</span>,</span><br><span class="line">  <span class="title class_">Object</span> = <span class="string">&#x27;object&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TypeMap</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="title class_">TypeValue</span>&gt; = &#123;</span><br><span class="line">  <span class="string">&#x27;[object Boolean]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Boolean</span>, </span><br><span class="line">  <span class="string">&#x27;[object Number]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Number</span>,</span><br><span class="line">  <span class="string">&#x27;[object String]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">String</span>,</span><br><span class="line">  <span class="string">&#x27;[object Function]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Function</span>,</span><br><span class="line">  <span class="string">&#x27;[object Array]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Array</span>,</span><br><span class="line">  <span class="string">&#x27;[object Date]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Date</span>,</span><br><span class="line">  <span class="string">&#x27;[object RegExp]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">RegExp</span>,</span><br><span class="line">  <span class="string">&#x27;[object Undefined]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Undefined</span>,</span><br><span class="line">  <span class="string">&#x27;[object Null]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Null</span>,</span><br><span class="line">  <span class="string">&#x27;[object Object]&#x27;</span>: <span class="title class_">TypeValue</span>.<span class="property">Object</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Validate data type.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">typeOf</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; <span class="variable">obj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">typeOf</span>(<span class="params"><span class="attr">obj</span>: <span class="built_in">unknown</span></span>): <span class="title class_">TypeValue</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> toString = <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">TypeMap</span>[toString.<span class="title function_">call</span>(obj)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">typeOf</span>(<span class="string">&#x27;abc&#x27;</span>)); <span class="comment">// string</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">typeOf</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])); <span class="comment">// array</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">typeOf</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;)); <span class="comment">// object</span></span><br></pre></td></tr></table></figure></li><li><h4 id="deepCopy-data"><a href="#deepCopy-data" class="headerlink" title="deepCopy(data)"></a>deepCopy(data)</h4><p>ディープコピー。</p><blockquote><p>このメソッドは <code>typeOf()</code> メソッドと組み合わせて使用します</p></blockquote><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Data deep copy.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">deepCopy</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">array|object</span>&#125; <span class="variable">data</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">array|object</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> deepCopy&lt;T&gt;(<span class="attr">data</span>: T): T &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">type</span>: <span class="title class_">TypeValue</span> = <span class="title function_">typeOf</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="title class_">TypeValue</span>.<span class="property">Array</span>: &#123;</span><br><span class="line">      <span class="keyword">const</span> <span class="attr">array</span>: <span class="built_in">unknown</span>[] = [];</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; (data <span class="keyword">as</span> <span class="built_in">unknown</span>[]).<span class="property">length</span>; index++) &#123;</span><br><span class="line">        array.<span class="title function_">push</span>(<span class="title function_">deepCopy</span>(data[index]));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> array <span class="keyword">as</span> T;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="title class_">TypeValue</span>.<span class="property">Object</span>: &#123;</span><br><span class="line">      <span class="keyword">const</span> <span class="attr">object</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">unknown</span>&gt; = &#123;&#125;;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(data, key)) &#123;</span><br><span class="line">          <span class="built_in">object</span>[key] = <span class="title function_">deepCopy</span>(data[key]);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">object</span> <span class="keyword">as</span> T;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> data;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = <span class="title function_">deepCopy</span>(obj1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj1 === obj2); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li><li><h4 id="formatDate-date-format"><a href="#formatDate-date-format" class="headerlink" title="formatDate(date, format)"></a>formatDate(date, format)</h4><p>日付フォーマット。</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Time and date formatting.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">formatDate</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string|date</span>&#125; <span class="variable">time</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">formatDate</span>(<span class="params"><span class="attr">time</span>: <span class="built_in">string</span> | <span class="title class_">Date</span>, format = <span class="string">&#x27;yyyy-MM-dd hh:mm:ss&#x27;</span></span>): <span class="built_in">string</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">date</span>: <span class="title class_">Date</span> = time ? <span class="keyword">new</span> <span class="title class_">Date</span>(time) : <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">dateValues</span>: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">number</span>&gt; = &#123;</span><br><span class="line">    <span class="string">&#x27;M+&#x27;</span>: date.<span class="title function_">getMonth</span>() + <span class="number">1</span>, <span class="comment">// 月</span></span><br><span class="line">    <span class="string">&#x27;d+&#x27;</span>: date.<span class="title function_">getDate</span>(), <span class="comment">// 日</span></span><br><span class="line">    <span class="string">&#x27;h+&#x27;</span>: date.<span class="title function_">getHours</span>(), <span class="comment">// 時</span></span><br><span class="line">    <span class="string">&#x27;m+&#x27;</span>: date.<span class="title function_">getMinutes</span>(), <span class="comment">// 分</span></span><br><span class="line">    <span class="string">&#x27;s+&#x27;</span>: date.<span class="title function_">getSeconds</span>(), <span class="comment">// 秒</span></span><br><span class="line">    <span class="string">&#x27;q+&#x27;</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>((date.<span class="title function_">getMonth</span>() + <span class="number">3</span>) / <span class="number">3</span>), <span class="comment">// 季度</span></span><br><span class="line">    <span class="string">&#x27;S&#x27;</span>: date.<span class="title function_">getMilliseconds</span>() <span class="comment">// ミリ秒</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="regexp">/(y&#123;4&#125;)/</span>.<span class="title function_">test</span>(format)) &#123;</span><br><span class="line">    format = format.<span class="title function_">replace</span>(<span class="title class_">RegExp</span>.<span class="property">$1</span>, (date.<span class="title function_">getFullYear</span>() + <span class="string">&#x27;&#x27;</span>).<span class="title function_">substr</span>(<span class="number">4</span> - <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span>));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> dateValues) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;(&#x27;</span> + key + <span class="string">&#x27;)&#x27;</span>).<span class="title function_">test</span>(format)) &#123;</span><br><span class="line">      <span class="keyword">const</span> value = dateValues[key].<span class="title function_">toString</span>();</span><br><span class="line">      format = format.<span class="title function_">replace</span>(<span class="title class_">RegExp</span>.<span class="property">$1</span>, (<span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span> === <span class="number">1</span>) ? value : (<span class="string">&#x27;00&#x27;</span> + value).<span class="title function_">substr</span>(value.<span class="property">length</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> format;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">formatDate</span>(<span class="string">&#x27;2024-05-01&#x27;</span>)); <span class="comment">// &#x27;2024-05-01 00:00:00&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">formatDate</span>(<span class="string">&#x27;2024-05-01&#x27;</span>, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>)); <span class="comment">// &#x27;2024-05-01&#x27;</span></span><br></pre></td></tr></table></figure></li><li><h4 id="uuid"><a href="#uuid" class="headerlink" title="uuid()"></a>uuid()</h4><p>UUID を生成します。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">uuid</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uuid</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#x27;</span>.<span class="title function_">replace</span>(<span class="regexp">/[xy]/g</span>, <span class="keyword">function</span> (<span class="params">c</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> r = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">16</span> | <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> v = c === <span class="string">&#x27;x&#x27;</span> ? r : (r &amp; <span class="number">0x3</span> | <span class="number">0x8</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v.<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">uuid</span>()); <span class="comment">// xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</span></span><br></pre></td></tr></table></figure></li><li><h4 id="download-url-name"><a href="#download-url-name" class="headerlink" title="download(url, name)"></a>download(url, name)</h4><p>ダウンロード。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">download</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">url</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">name</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">download</span>(<span class="params">url, name</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> aDom = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">  aDom.<span class="property">download</span> = name;</span><br><span class="line">  aDom.<span class="property">href</span> = url;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(aDom);</span><br><span class="line">  aDom.<span class="title function_">click</span>();</span><br><span class="line">  aDom.<span class="title function_">remove</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">download</span>(<span class="string">&#x27;word.docx&#x27;</span>, <span class="string">&#x27;https://www.test.com/word.docx&#x27;</span>)); <span class="comment">// word.docx</span></span><br></pre></td></tr></table></figure></li><li><h4 id="getUrlArg-name"><a href="#getUrlArg-name" class="headerlink" title="getUrlArg(name)"></a>getUrlArg(name)</h4><p>名前でパスパラメータを取得します。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">getUrlArg</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">name</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUrlArg</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> search = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>;</span><br><span class="line">  <span class="keyword">const</span> regexp = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`(^|&amp;)<span class="subst">$&#123;name&#125;</span>=([^&amp;]*)(&amp;|$)`</span>);</span><br><span class="line">  <span class="keyword">const</span> arg = search.<span class="title function_">substr</span>(<span class="number">1</span>).<span class="title function_">match</span>(regexp);</span><br><span class="line">  <span class="keyword">return</span> arg ? arg[<span class="number">2</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h4 id="getUrlQuery-url"><a href="#getUrlQuery-url" class="headerlink" title="getUrlQuery(url)"></a>getUrlQuery(url)</h4><p>パスパラメータをオブジェクト形式に変換します。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">getUrlQuery</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">url</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">object</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getUrlQuery</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> query = url.<span class="title function_">substring</span>(url.<span class="title function_">indexOf</span>(<span class="string">&#x27;?&#x27;</span>) + <span class="number">1</span>).<span class="title function_">split</span>(<span class="string">&#x27;&amp;&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> params = &#123;&#125;;</span><br><span class="line">  query.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> key_value = item.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">    params[key_value[<span class="number">0</span>]] = key_value[<span class="number">1</span>];</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> params;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&#x27;https://www.test.com/query?a=1&amp;b=2&amp;c=3&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getUrlQuery</span>(url)); <span class="comment">// &#123; a: 1, b: 2, c: 3 &#125;</span></span><br></pre></td></tr></table></figure></li><li><h4 id="setUrlQuery-url"><a href="#setUrlQuery-url" class="headerlink" title="setUrlQuery(url)"></a>setUrlQuery(url)</h4><p>オブジェクト形式をパスパラメータに変換します。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">setUrlQuery</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; <span class="variable">params</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setUrlQuery</span>(<span class="params">params</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> querys = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> params) &#123;</span><br><span class="line">    <span class="keyword">if</span> (params.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">      querys.<span class="title function_">push</span>(key + <span class="string">&#x27;=&#x27;</span> + params[key]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> querys.<span class="title function_">join</span>(<span class="string">&#x27;&amp;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> params = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">setUrlQuery</span>(params)); <span class="comment">// &#x27;a=1&amp;b=2&amp;c=3&#x27;</span></span><br></pre></td></tr></table></figure></li><li><h4 id="getDeepValueOfObject-object-keyPath-defaultValue"><a href="#getDeepValueOfObject-object-keyPath-defaultValue" class="headerlink" title="getDeepValueOfObject(object, keyPath, defaultValue)"></a>getDeepValueOfObject(object, keyPath, defaultValue)</h4><p>オブジェクトの深い値を取得します。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">getDeepValueOfObject</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">object|array</span>&#125; <span class="variable">object</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">keyPath</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; [defaultValue]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">any</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDeepValueOfObject</span>(<span class="params">object, keyPath, defaultValue</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> isString = <span class="keyword">typeof</span> keyPath === <span class="string">&#x27;string&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (!isString) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&#x27;[getDeepValueOfObject warn]: keyPath is not a string, type &#x27;</span> + <span class="keyword">typeof</span> keyPath);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (object &amp;&amp; keyPath &amp;&amp; isString) &#123;</span><br><span class="line">    <span class="keyword">const</span> keys = keyPath.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    <span class="keyword">let</span> value = object;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; keys.<span class="property">length</span>; index++) &#123;</span><br><span class="line">      <span class="keyword">const</span> key = keys[index];</span><br><span class="line">      <span class="keyword">if</span> (value[key] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        value = value[key];</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        value = defaultValue;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> defaultValue;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">foo</span>: &#123;</span><br><span class="line">    <span class="attr">number</span>: <span class="number">3</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> arr = [ obj ];</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(obj, <span class="string">&#x27;foo.number&#x27;</span>)); <span class="comment">// 3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(obj, <span class="string">&#x27;bar.number&#x27;</span>)); <span class="comment">// undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(obj, <span class="string">&#x27;bar.number&#x27;</span>, <span class="string">&#x27;default&#x27;</span>)); <span class="comment">// &#x27;default&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(obj, <span class="string">&#x27;&#x27;</span>)); <span class="comment">// undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(obj, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;default&#x27;</span>)); <span class="comment">// &#x27;default&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(arr, <span class="number">0</span>)); <span class="comment">// undefined</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getDeepValueOfObject</span>(arr, <span class="string">&#x27;0.foo.number&#x27;</span>)); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure></li><li><h4 id="toThousands-number"><a href="#toThousands-number" class="headerlink" title="toThousands(number)"></a>toThousands(number)</h4><p>千位区切り形式に変換します。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@method</span> <span class="variable">toThousands</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number|string</span>&#125; <span class="variable">number</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">string</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toThousands</span>(<span class="params">number</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="title class_">Number</span>(number)) &gt;= <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [integer, float] = (number || <span class="number">0</span>).<span class="title function_">toString</span>().<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> thousandsInteger = integer.<span class="title function_">replace</span>(<span class="regexp">/(\d)(?=(?:\d&#123;3&#125;)+$)/g</span>, <span class="string">&#x27;$1,&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> thousandsInteger + (float ? <span class="string">&#x27;.&#x27;</span> + float : <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> number;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></div></article></section><footer id="footer"><div class="footer-wrapper"><a href="/" class="footer-title">柳政のブログ</a><p>テーマは Lite から</p></div><div class="frosted-glass"></div></footer></div></div><script src="/js/i18n.js"></script></body></html>