"use strict";function Search(t){t=t||{},this.url=t.url||"",this.keywordClassName=t.keywordClassName||"",this.keywordBeforeLength=t.keywordBeforeLength||20,this.keywordAfterLength=t.keywordAfterLength||30,this.ellipsis=t.ellipsis||"...",this.data=[],this.onDataLoadSucceeded=null,this.onDataLoadFailed=null,this.url&&this.getData()}Search.prototype.matchMarkdown=function(){return["(^ *|\\s+)(# *)+","(^ *|\\s+)([*+-]|[0-9]+\\.) +","```([\\s\\S]*?)``` *","!?\\[(?=[\\s\\S]*?\\]\\([\\s\\S]*?\\))","\\]\\([\\s\\S]*?\\)","(^ *|\\s+)(> *([*+-] +|[0-9]+\\. +)?)+","<[^>]+>","(^ *|\\s+)([*-] *)+"].join("|")},Search.prototype.getData=function(){var _this=this,xmlhttp=null;if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest;else if(window.ActiveXObject)try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){return void(_this.onDataLoadFailed&&_this.onDataLoadFailed("XMLHttpRequest not supported"))}}xmlhttp?(xmlhttp.open("GET",_this.url,!0),xmlhttp.send(null),xmlhttp.onreadystatechange=function(){if(4===xmlhttp.readyState)switch(xmlhttp.status){case 200:try{var data;data="undefined"!=typeof JSON&&JSON.parse?JSON.parse(xmlhttp.responseText):eval("("+xmlhttp.responseText+")");for(var match=new RegExp(_this.matchMarkdown(),"g"),i=0;i<data.length;i++)data[i]&&data[i].content&&(data[i].content=data[i].content.replace(match," ").trim());_this.data=data,_this.onDataLoadSucceeded&&_this.onDataLoadSucceeded(data)}catch(t){_this.onDataLoadFailed&&_this.onDataLoadFailed("JSON parse error: "+t.message)}break;case 404:_this.onDataLoadFailed&&_this.onDataLoadFailed("404 Not Found");break;default:_this.onDataLoadFailed&&_this.onDataLoadFailed("HTTP Error: "+xmlhttp.status)}},xmlhttp.onerror=function(t){_this.onDataLoadFailed&&_this.onDataLoadFailed(t||"Network error")}):_this.onDataLoadFailed&&_this.onDataLoadFailed("XMLHttpRequest not supported")},Search.prototype.search=function(t){var e=this,a=[];if(!t||"string"!=typeof t)return a;for(var n=0;n<this.data.length;n++){var o=this.data[n],s=o.title||"",r=o.content||"",i=o.url||"",h=e.ellipsis,d=e.keywordBeforeLength,l=e.keywordAfterLength,c=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),p=function(t){return'<em class="'+e.keywordClassName+'">'+t+"</em>"},u=s.search(c),L=r.search(c);if(u>-1||L>-1){var m=0,f=0,g={url:i,title:s,content:""};u>-1&&(f=l,g.title=s.replace(c,p),g.content=r.substring(0,f)),L>-1&&((m=L-d)<0&&(m=0),(f=L+t.length+l)>r.length&&(f=r.length),g.content=r.substring(m,f).replace(c,p));var w=0===m?"":h,x=f>=r.length||0===f?"":h;g.content=w+g.content+x,a.push(g)}}return a};