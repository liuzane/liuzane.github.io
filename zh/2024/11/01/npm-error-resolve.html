<!doctype html><html lang="en"><head><meta charset="utf-8"><title>NPM Error Resolve</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="google-site-verification" content="7if7tEoBzofIpEcyTBbXYj68Uwni_Udf_J_RnIMKkx0"><link rel="alternate" href="https://liuzane.github.io/en" hreflang="en"><link rel="alternate" href="https://liuzane.github.io/zh" hreflang="zh"><link rel="alternate" href="https://liuzane.github.io/ja" hreflang="ja"><link rel="alternate" href="https://liuzane.github.io" hreflang="x-default"><link rel="canonical" href="https://liuzane.github.io/zh/2024/11/01/npm-error-resolve.html"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/article.css"></head><body><div id="container"><div id="nav"><nav id="nav-wrap"><a class="nav-link" href="/zh">首页</a> <a class="nav-link" href="/zh/archives">归档</a> <a class="nav-link" href="/zh/categories">分类</a> <a class="nav-link" href="https://liuzane.github.io/tools" target="_blank">工具</a> <a class="nav-link" href="https://liuzane.github.io/laboratory" target="_blank">实验室</a> <a class="nav-link" href="/zh/about">关于</a></nav><div class="frosted-glass"></div></div><div id="nav-lang"><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em"><path d="M512 742.4a230.4 230.4 0 1 0 0-460.8 230.4 230.4 0 0 0 0 460.8z m0 57.6a288 288 0 1 1 0-576 288 288 0 0 1 0 576zM380.256 267.2l25.664-13.984c0-0.8-0.032-0.832 4.832 3.2 25.6 26.976 38.368 49.92 38.368 68.8 0 5.312 0.192 10.08 0.736 19.776 1.792 31.232 1.376 43.04-5.664 58.88-10.848 24.544-34.176 36.544-67.072 36.544-27.456 0-49.696 6.464-88.96 23.296-30.4 13.024-33.28 14.208-45.952 18.432l10.592-41.728c10.432-3.456-15.68-17.504 12.704-29.664 45.888-19.648 74.336-27.936 111.616-27.936 7.392 0 12-0.896 14.208-2.048 1.92-4.128 2.24-11.712 1.024-32.512-0.64-10.752-0.832-16.288-0.832-23.04 0-8.256-16.48-23.552-17.632-24.512-16.8-13.984 6.4-12.832 6.4-33.504z m225.312 325.728c-24.896-13.632-41.024-28.512-48.896-52.096-2.656-8-8.832-13.952-20.128-19.712-5.248-2.656-24.832-10.624-27.776-12.032-15.68-7.52-25.568-16.544-25.568-34.944 0-16.224 0.864-27.68 4.512-41.856 5.952-23.008 17.92-42.144 37.824-54.592 17.664-11.04 36.288-12.128 56.832-5.92 6.848 2.048 13.568 4.736 22.784 8.864-0.928-0.448 16.96 7.68 22.24 9.984 12.736 5.472 23.808 9.408 35.584 12.352a205.216 205.216 0 0 0 101.248 0l13.952 55.904a262.784 262.784 0 0 1-129.152 0 283.04 283.04 0 0 1-44.416-15.36c-47.584-20.48-44.448-19.52-48.544-16.96-8.896 5.568-13.312 16.864-14.72 33.792 6.784 2.848 16.416 6.944 21.344 9.44 23.584 12 40.448 28.32 48.64 52.832 2.208 6.592 8.544 12.48 21.888 19.776 3.2 1.76 17.12 8.832 20.64 10.752 26.528 14.624 40.512 33.184 28.736 61.6-9.152 22.08-25.088 32.928-54.72 44.576-0.96 0.384-19.648 7.488-25.152 9.76-9.28 3.808-17.024 7.488-24.224 11.648a137.6 137.6 0 0 0-7.328 4.544c-19.904 13.28-30.368 37.728-30.368 76.864h-57.6c0-56.896 18.336-99.648 56-124.8 3.424-2.24 6.88-4.384 10.432-6.432a248.64 248.64 0 0 1 31.232-15.136c6.304-2.56 25.568-9.92 25.92-10.048a168.32 168.32 0 0 0 12.768-5.504 1102.944 1102.944 0 0 1-13.984-7.296z" p-id="1465"></path></svg></div><div id="nav-lang-list"><a class="lang-link" href="/en/2024/11/01/npm-error-resolve.html" hreflang="en">English</a> <a class="lang-link" href="/zh/2024/11/01/npm-error-resolve.html" hreflang="zh">简体中文</a> <a class="lang-link" href="/ja/2024/11/01/npm-error-resolve.html" hreflang="ja">日本語</a></div><div id="wrapper"><header id="header"><div class="header-wrapper"><img src="/images/aodamiao.jpg" class="header-avatar"><p class="header-author">柳政</p><p class="header-description">好好学习，天天向上</p></div><div class="frosted-glass"></div></header><section id="content"><article class="article"><a class="article-back" href="javascript: history.back(-1)">&lt; 返回</a><header class="article-header"><h1 class="article-title">NPM Error Resolve</h1><div class="article-meta"><time datetime="2024-11-01T07:03:05.000Z" class="article-date">2024-11-01</time></div></header><div class="article-content"><h3 id="postinstall-error"><a href="#postinstall-error" class="headerlink" title="postinstall error"></a>postinstall error</h3><table><thead><tr><th>环境</th><th>版本</th></tr></thead><tbody><tr><td>windows</td><td>10</td></tr><tr><td>node</td><td>20.14.0</td></tr><tr><td>pnpm</td><td>9.4.0</td></tr></tbody></table><p>当第一次执行 <code>pnpm install</code> 或 <code>npm install</code> 时 PNPM报错：npm postinstall failed command not found node ./scripts/postinstall.js<br><img src="./npm-error-resolve/2024-11-01-150359.png" alt=" "></p><h4 id="解决方案1："><a href="#解决方案1：" class="headerlink" title="解决方案1："></a>解决方案1：</h4><p>运行命令<br><code>rimraf .\node_modules\</code><br><code>npm cache clean --force</code><br><code>pnpm store prune</code></p><h4 id="解决方案2："><a href="#解决方案2：" class="headerlink" title="解决方案2："></a>解决方案2：</h4><ol><li><p>找到报错的插件所在的 package.json 文件</p></li><li><p>把 package.json 中的 scripts.postinstall 的命令找个地方记录下来，并修改命令为 <code>pnpm --version</code></p></li><li><p>然后执行一次 <code>pnpm install</code> 完成后将会发现报错的插件 postinstall 执行成功</p></li><li><p>挨个进入报错的插件所在的 package.json 文件层级</p></li><li><p>挨个执行该插件原有的 postinstall 命令</p></li><li><p><code>pnpm dev</code> 启动成功。。。</p></li></ol><h3 id="node-pre-gyp-error"><a href="#node-pre-gyp-error" class="headerlink" title="node-pre-gyp error"></a>node-pre-gyp error</h3><table><thead><tr><th>插件</th><th>版本</th></tr></thead><tbody><tr><td>linux</td><td>13.6.0</td></tr><tr><td>node</td><td>18.20.4</td></tr><tr><td>npm</td><td>10.7.0</td></tr></tbody></table><p>当第一次执行 <code>npm install</code> 时，有时会出现 npm error node-pre-gyp。<br><img src="./npm-error-resolve/2024-11-01-154318.png" alt=" "></p><h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p><a target="_blank" rel="noopener" href="https://github.com/mozilla/pdf.js#user-content-getting-the-code">https://github.com/mozilla/pdf.js#user-content-getting-the-code</a></p><blockquote><p>On MacOS M1/M2 you may see some node-gyp-related errors when running npm install. This is because one of our dependencies, “canvas”, does not provide pre-built binaries for this platform and instead npm will try to build it from source. Please make sure to first install the necessary native dependencies using brew: <a target="_blank" rel="noopener" href="https://github.com/Automattic/node-canvas#compiling">https://github.com/Automattic/node-canvas#compiling</a>.</p></blockquote><h4 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h4><ol><li><p>参考 <a target="_blank" rel="noopener" href="https://github.com/Automattic/node-canvas#compiling">https://github.com/Automattic/node-canvas#compiling</a> 给的解决办法，给环境添加图片插件支持。</p></li><li><p>移除项目中所有与 canvas (项目名: node-canvas) 相关的插件。</p></li></ol></div></article></section><footer id="footer"><div class="footer-wrapper"><a href="/" class="footer-title">柳政的博客</a><p>主题由 Lite 提供</p></div><div class="frosted-glass"></div></footer></div></div><script src="/js/i18n.js"></script></body></html>